<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•ç‡§Ø‡§æ‡§ö | Memory Match</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; }
        body {
            font-family: 'Noto Sans Devanagari', system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; 
            display: flex; 
            flex-direction: column; 
            color: #333; 
            touch-action: manipulation;
            -webkit-text-size-adjust: 100%;
        }
        .header {
            background: rgba(0, 0, 0, 0.8); 
            padding: 10px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        .header a { 
            color: #ffd700; 
            font-size: clamp(14px, 3.5vw, 18px); 
            font-weight: 700; 
            text-decoration: none; 
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5); 
        }
        .container { 
            width: 100%; 
            max-width: 900px; 
            margin: 0 auto; 
            padding: 10px; 
            flex-grow: 1; 
            display: flex; 
            flex-direction: column;
        }
        .title { 
            text-align: center; 
            font-size: clamp(18px, 4.5vw, 26px); 
            font-weight: 700; 
            color: #fff; 
            padding: 8px 0; 
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); 
        }
        .instructions, .contact { 
            background: rgba(255, 255, 255, 0.95); 
            border-radius: 12px; 
            padding: 12px; 
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.1); 
            backdrop-filter: blur(8px); 
            border: 1px solid rgba(255, 255, 255, 0.2); 
            margin-bottom: 8px; 
        }
        .instructions h2 { 
            font-size: clamp(14px, 3.5vw, 18px); 
            color: #4a5568; 
            text-align: center; 
            margin-bottom: 6px; 
        }
        .instructions ul { 
            list-style: none; 
            color: #718096; 
            font-size: clamp(11px, 2.8vw, 13px); 
        }
        .instructions li { 
            margin-bottom: 5px; 
            padding-left: 16px; 
            position: relative; 
        }
        .instructions li::before { 
            content: 'üÉè'; 
            position: absolute; 
            left: 0; 
            top: 0; 
        }
        .dashain-message { 
            background: linear-gradient(135deg, #ff6b6b, #ee5a24); 
            color: white; 
            text-align: center; 
            padding: 10px; 
            border-radius: 12px; 
            margin: 4px 0; 
            font-size: clamp(11px, 2.8vw, 13px); 
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.1); 
            animation: pulse 2s infinite; 
        }
        @keyframes pulse { 
            0%, 100% { transform: scale(1); } 
            50% { transform: scale(1.02); } 
        }
        .stats-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 8px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 6px;
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.1);
        }
        .stat { 
            background: rgba(255, 255, 255, 0.95); 
            padding: 5px 10px; 
            border-radius: 12px; 
            font-size: clamp(10px, 2.2vw, 14px); 
            font-weight: 600; 
            color: #2d3748; 
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1); 
        }
        #high-score, #best-time { 
            background: rgba(255, 215, 0, 0.95); 
        }
        #game-container {
            position: relative; 
            width: 100%; 
            height: clamp(360px, 55vh, 560px); 
            border-radius: 12px;
            background: linear-gradient(180deg, #87ceeb 0%, #98d8e8 80%, #4a8e4c 100%);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2); 
            border: 3px solid #3b5998; 
            overflow: hidden;
            touch-action: none;
        }
        #game-area { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 8px; 
            padding: 8px; 
        }
        #game-over, #start-screen {
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0, 0, 0, 0.7);
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 300;
        }
        #game-over { 
            display: none; 
            flex-direction: column; 
            color: white; 
            text-align: center; 
            gap: 6px; 
            padding: 10px;
        }
        #game-over h2 { 
            font-size: clamp(20px, 5vw, 28px); 
            margin-bottom: 6px; 
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            background-clip: text; 
        }
        #game-over p { 
            font-size: clamp(12px, 3vw, 16px); 
            opacity: 0.95; 
        }
        .play-btn, .restart-btn, .screenshot-btn, .fullscreen-btn, .cancel-fullscreen-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d); 
            border: none; 
            padding: 10px 20px; 
            border-radius: 20px; 
            color: white; 
            font-size: clamp(14px, 3.5vw, 18px); 
            font-weight: 700; 
            cursor: pointer; 
            box-shadow: 0 3px 12px rgba(78, 205, 196, 0.4);
            touch-action: manipulation;
        }
        .play-btn:hover, .restart-btn:hover, .screenshot-btn:hover, .fullscreen-btn:hover, .cancel-fullscreen-btn:hover { 
            transform: translateY(-3px); 
        }
        .fullscreen-btn, .cancel-fullscreen-btn {
            display: none;
        }
        .share-buttons { 
            display: flex; 
            gap: 6px; 
            margin-top: 6px; 
            flex-wrap: wrap; 
            justify-content: center; 
        }
        .share-btn { 
            padding: 8px 16px; 
            border-radius: 18px; 
            font-size: clamp(12px, 3vw, 14px); 
            font-weight: 600; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            gap: 5px; 
            color: white; 
            text-decoration: none; 
        }
        .tiktok-btn { 
            background: linear-gradient(45deg, #ff0050, #ff4d6d); 
            box-shadow: 0 3px 12px rgba(255, 0, 80, 0.4); 
        }
        .facebook-btn { 
            background: linear-gradient(45deg, #3b5998, #4267b2); 
            box-shadow: 0 3px 12px rgba(59, 89, 152, 0.4); 
        }
        .card {
            position: relative; 
            width: 100%; 
            height: 100%; 
            perspective: 1000px; 
            cursor: pointer; 
            user-select: none; 
            -webkit-user-select: none; 
            touch-action: manipulation;
        }
        .card-inner {
            position: relative; 
            width: 100%; 
            height: 100%; 
            transition: transform 0.5s; 
            transform-style: preserve-3d; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25); 
            border-radius: 8px;
        }
        .card.flipped .card-inner { 
            transform: rotateY(180deg); 
        }
        .card-front, .card-back {
            position: absolute; 
            width: 100%; 
            height: 100%; 
            backface-visibility: hidden; 
            border-radius: 8px; 
            display: flex; 
            align-items: center; 
            justify-content: center;
        }
        .card-front { 
            background: linear-gradient(45deg, #3b5998, #4267b2); 
            color: white; 
            font-size: clamp(16px, 4vw, 24px); 
        }
        .card-back { 
            background-size: cover; 
            background-position: center; 
            transform: rotateY(180deg); 
        }
        .image1 { background-image: url('mimage/m1.jpg'); }
        .image2 { background-image: url('mimage/m2.jpg'); }
        .image3 { background-image: url('mimage/m3.jpg'); }
        .image4 { background-image: url('mimage/m4.jpg'); }
        .image5 { background-image: url('mimage/m5.jpg'); }
        .image6 { background-image: url('mimage/m6.jpg'); }
        .image7 { background-image: url('mimage/m7.jpg'); }
        .image8 { background-image: url('mimage/m8.jpg'); }
        .footer { 
            text-align: center; 
            padding: 8px 0; 
            color: white; 
            font-size: clamp(9px, 2.2vw, 11px); 
        }
        .social-links { 
            display: flex; 
            justify-content: center; 
            gap: 10px; 
            margin-top: 6px; 
        }
        .social-link { 
            width: 32px; 
            height: 32px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            text-decoration: none; 
            color: white; 
            font-size: 16px; 
            transition: transform 0.3s ease; 
        }
        .tiktok-social { 
            background: linear-gradient(45deg, #ff0050, #ff4d6d); 
        }
        .facebook-social { 
            background: linear-gradient(45deg, #3b5998, #4267b2); 
        }
        @media (max-width: 768px) {
            #game-container {
                height: clamp(320px, 50vh, 480px);
            }
            #game-area { 
                grid-template-columns: repeat(4, 1fr); 
                gap: 6px; 
                padding: 6px; 
            }
            .stats-container { 
                padding: 6px; 
                gap: 5px; 
            }
            .stat { 
                padding: 4px 8px; 
                font-size: clamp(9px, 2vw, 12px); 
            }
            .share-buttons { 
                flex-direction: row; 
                width: 100%; 
                justify-content: center; 
            }
            .fullscreen-btn {
                display: block;
                margin: 8px auto;
            }
        }
        @media (max-width: 480px) {
            #game-container {
                height: clamp(280px, 45vh, 400px);
            }
            #game-area { 
                grid-template-columns: repeat(2, 1fr); 
                gap: 5px; 
                padding: 5px; 
            }
            .card-front { 
                font-size: clamp(14px, 3.5vw, 20px); 
            }
            .stats-container { 
                flex-direction: column; 
                align-items: center; 
            }
            .share-buttons { 
                flex-direction: column; 
                align-items: center; 
            }
        }
        .fullscreen-mode #game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            border-radius: 0;
            border: none;
        }
        .fullscreen-mode .cancel-fullscreen-btn {
            display: block;
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 400;
        }
        .fullscreen-mode .container {
            padding: 0;
        }
        .fullscreen-mode .stats-container,
        .fullscreen-mode .instructions,
        .fullscreen-mode .dashain-message,
        .fullscreen-mode .contact,
        .fullscreen-mode .footer,
        .fullscreen-mode .header {
            display: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="index.html" target="_blank" rel="noopener">RSTECHZEN Game Zone</a>
    </div>

    <div class="container">
        <h1 class="title">‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•ç‡§Ø‡§æ‡§ö</h1>

        <div class="dashain-message">üéâ ‡§∂‡•Å‡§≠ ‡§¶‡§∂‡•à‡§Ç‡§ï‡•ã ‡§π‡§æ‡§∞‡•ç‡§¶‡§ø‡§ï ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ! ‡§ï‡§æ‡§∞‡•ç‡§°‡§π‡§∞‡•Ç ‡§Æ‡•ç‡§Ø‡§æ‡§ö ‡§ó‡§∞‡•á‡§∞ ‡§Ü‡§®‡§®‡•ç‡§¶ ‡§≤‡§ø‡§®‡•Å‡§π‡•ã‡§∏‡•ç! ü•≥</div>

        <div class="instructions">
            <h2>‡§ï‡§∏‡§∞‡•Ä ‡§ñ‡•á‡§≤‡•ç‡§®‡•á?</h2>
            <ul>
                <li>‡§ñ‡•á‡§≤ ‡§∏‡•Å‡§∞‡•Å ‡§ó‡§∞‡•ç‡§® "‡§ñ‡•á‡§≤‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç" ‡§¨‡§ü‡§® ‡§•‡§ø‡§ö‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç‡•§</li>
                <li>‡§ï‡§æ‡§∞‡•ç‡§°‡§π‡§∞‡•Ç‡§Æ‡§æ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ó‡§∞‡•á‡§∞ ‡§Æ‡•ç‡§Ø‡§æ‡§ö‡§ø‡§ô ‡§ú‡•ã‡§°‡•Ä‡§π‡§∞‡•Ç ‡§´‡•á‡§≤‡§æ ‡§™‡§æ‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç‡•§</li>
                <li>‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§Æ‡•ç‡§Ø‡§æ‡§ö‡§≤‡•á ‡•ß‡•¶ ‡§Ö‡§Ç‡§ï ‡§•‡§™‡§ø‡§®‡•ç‡§õ, ‡§ó‡§≤‡§§ ‡§Æ‡•ç‡§Ø‡§æ‡§ö‡§≤‡•á ‡•ß ‡§ó‡§≤‡•ç‡§§‡•Ä ‡§∞ ‡•ß ‡§ö‡§æ‡§≤ ‡§ó‡§£‡§®‡§æ ‡§ó‡§∞‡•ç‡§õ‡•§</li>
                <li>‡§∏‡§¨‡•à ‡§ú‡•ã‡§°‡•Ä‡§π‡§∞‡•Ç ‡§Æ‡•ç‡§Ø‡§æ‡§ö ‡§ó‡§∞‡•á‡§™‡§õ‡§ø ‡§ñ‡•á‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•Å‡§®‡•ç‡§õ!</li>
            </ul>
        </div>

        <div class="stats-container">
            <div class="stat" id="score">‡§∏‡•ç‡§ï‡•ã‡§∞: ‡•¶</div>
            <div class="stat" id="moves">‡§ö‡§æ‡§≤‡§π‡§∞‡•Ç: ‡•¶</div>
            <div class="stat" id="mistakes">‡§ó‡§≤‡•ç‡§§‡•Ä‡§π‡§∞‡•Ç: ‡•¶</div>
            <div class="stat" id="timer">‡§∏‡§Æ‡§Ø: ‡•¶:‡•¶‡•¶</div>
            <div class="stat" id="high-score">‡§â‡§ö‡•ç‡§ö ‡§∏‡•ç‡§ï‡•ã‡§∞: ‡•¶</div>
            <div class="stat" id="best-time">‡§â‡§§‡•ç‡§§‡§Æ ‡§∏‡§Æ‡§Ø: --:--</div>
        </div>

        <button class="fullscreen-btn" id="fullscreenBtn">‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§®</button>

        <div id="game-container">
            <div id="game-area"></div>

            <div id="start-screen">
                <button class="play-btn" id="playBtn">‡§ñ‡•á‡§≤‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</button>
            </div>

            <div id="game-over">
                <h2>‡§ñ‡•á‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§!</h2>
                <p>‡§§‡§™‡§æ‡§à‡§Ç‡§ï‡•ã ‡§∏‡•ç‡§ï‡•ã‡§∞: <span id="final-score">‡•¶</span></p>
                <p>‡§â‡§ö‡•ç‡§ö ‡§∏‡•ç‡§ï‡•ã‡§∞: <span id="final-high-score">‡•¶</span></p>
                <p>‡§ï‡•Å‡§≤ ‡§ö‡§æ‡§≤‡§π‡§∞‡•Ç: <span id="final-moves">‡•¶</span></p>
                <p>‡§ï‡•Å‡§≤ ‡§ó‡§≤‡•ç‡§§‡•Ä‡§π‡§∞‡•Ç: <span id="final-mistakes">‡•¶</span></p>
                <p>‡§∏‡§Æ‡§Ø: <span id="final-time">‡•¶:‡•¶‡•¶</span></p>
                <p>‡§â‡§§‡•ç‡§§‡§Æ ‡§∏‡§Æ‡§Ø: <span id="final-best-time">--:--</span></p>
                <button class="restart-btn" id="restartBtn">‡§´‡•á‡§∞‡§ø ‡§ñ‡•á‡§≤‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</button>
                <button class="screenshot-btn" id="screenshotBtn">‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§®‡§∏‡§ü ‡§≤‡§ø‡§®‡•Å‡§π‡•ã‡§∏‡•ç</button>
                <div class="share-buttons">
                    <a href="#" class="share-btn tiktok-btn" id="tiktokShare">üì± ‡§ü‡§ø‡§ï‡§ü‡§ï‡§Æ‡§æ ‡§∏‡•á‡§Ø‡§∞ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</a>
                    <a href="#" class="share-btn facebook-btn" id="facebookShare">üìò ‡§´‡•á‡§∏‡§¨‡•Å‡§ï‡§Æ‡§æ ‡§∏‡•á‡§Ø‡§∞ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</a>
                </div>
            </div>

            <button class="cancel-fullscreen-btn" id="cancelFullscreenBtn">‡§∞‡§¶‡•ç‡§¶ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</button>
        </div>

        <div class="contact">
            <p>‡§∏‡§Æ‡•ç‡§™‡§∞‡•ç‡§ï: <a href="tel:9808942229">9808942229</a> | ‡§á‡§Æ‡•á‡§≤: <a href="mailto:rstechzen@gmail.com">rstechzen@gmail.com</a></p>
        </div>

        <div class="footer">
            <p>‡§µ‡§ø‡§ï‡§æ‡§∏‡§ï‡§∞‡•ç‡§§‡§æ: ‡§∞‡§∏‡•ç‡§ü‡•á‡§ï‡§ú‡•á‡§® | Social ID: @rstechzen | <a href="https://rstechzen.rf.gd/" target="_blank" rel="noopener">‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü</a></p>
            <p>‡§ï‡•É‡§™‡§Ø‡§æ ‡§ü‡§ø‡§ï‡§ü‡§ï ‡§∞ ‡§´‡•á‡§∏‡§¨‡•Å‡§ï‡§Æ‡§æ ‡§π‡§æ‡§Æ‡•Ä‡§≤‡§æ‡§à ‡§´‡§≤‡•ã ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç!</p>
            <div class="social-links">
                <a href="https://www.facebook.com/rstechzen" class="social-link facebook-social" target="_blank" rel="noopener" aria-label="Facebook">f</a>
                <a href="https://www.tiktok.com/@rstechzen" class="social-link tiktok-social" target="_blank" rel="noopener" aria-label="TikTok">‚ô¨</a>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        // Elements
        const gameContainer = document.getElementById('game-container');
        const gameArea = document.getElementById('game-area');
        const startScreen = document.getElementById('start-screen');
        const playBtn = document.getElementById('playBtn');
        const restartBtn = document.getElementById('restartBtn');
        const screenshotBtn = document.getElementById('screenshotBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const cancelFullscreenBtn = document.getElementById('cancelFullscreenBtn');
        const scoreDisplay = document.getElementById('score');
        const movesDisplay = document.getElementById('moves');
        const mistakesDisplay = document.getElementById('mistakes');
        const timerDisplay = document.getElementById('timer');
        const highScoreDisplay = document.getElementById('high-score');
        const bestTimeDisplay = document.getElementById('best-time');
        const gameOverDisplay = document.getElementById('game-over');
        const finalScoreDisplay = document.getElementById('final-score');
        const finalHighScoreDisplay = document.getElementById('final-high-score');
        const finalMovesDisplay = document.getElementById('final-moves');
        const finalMistakesDisplay = document.getElementById('final-mistakes');
        const finalTimeDisplay = document.getElementById('final-time');
        const finalBestTimeDisplay = document.getElementById('final-best-time');
        const tiktokShare = document.getElementById('tiktokShare');
        const facebookShare = document.getElementById('facebookShare');

        // State
        let score = 0;
        let moves = 0;
        let mistakes = 0;
        let seconds = 0;
        let timerInterval = null;
        let highScore = parseInt(localStorage.getItem('memoryMatchHighScore') || '0', 10) || 0;
        let bestTime = parseInt(localStorage.getItem('memoryMatchBestTime') || '0', 10) || 0;
        let gameActive = false;
        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        const totalPairs = 8;

        // Initialize displays
        highScoreDisplay.textContent = `‡§â‡§ö‡•ç‡§ö ‡§∏‡•ç‡§ï‡•ã‡§∞: ${highScore}`;
        bestTimeDisplay.textContent = `‡§â‡§§‡•ç‡§§‡§Æ ‡§∏‡§Æ‡§Ø: ${bestTime ? formatTime(bestTime) : '--:--'}`;

        // Format time
        function formatTime(seconds) {
            const min = Math.floor(seconds / 60);
            const sec = seconds % 60;
            return `${min}:${sec < 10 ? '0' : ''}${sec}`;
        }

        // Start timer
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            seconds = 0;
            timerDisplay.textContent = `‡§∏‡§Æ‡§Ø: ${formatTime(seconds)}`;
            timerInterval = setInterval(() => {
                if (gameActive) {
                    seconds += 1;
                    timerDisplay.textContent = `‡§∏‡§Æ‡§Ø: ${formatTime(seconds)}`;
                }
            }, 1000);
        }

        // Save high score and best time
        function setHighScore(value) {
            localStorage.setItem('memoryMatchHighScore', value);
        }
        function setBestTime(value) {
            localStorage.setItem('memoryMatchBestTime', value);
        }

        // Card types
        const types = ['image1', 'image2', 'image3', 'image4', 'image5', 'image6', 'image7', 'image8', 'image1', 'image2', 'image3', 'image4', 'image5', 'image6', 'image7', 'image8'];

        // Shuffle array
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Create card
        function createCard(type) {
            const card = document.createElement('div');
            card.classList.add('card');
            card.dataset.type = type;
            const inner = document.createElement('div');
            inner.classList.add('card-inner');
            const front = document.createElement('div');
            front.classList.add('card-front');
            front.textContent = 'üÉè';
            const back = document.createElement('div');
            back.classList.add('card-back', type);
            inner.appendChild(front);
            inner.appendChild(back);
            card.appendChild(inner);
            
            card.addEventListener('click', () => handleCardClick(card));
            card.addEventListener('touchstart', (e) => {
                e.preventDefault();
                handleCardClick(card);
            }, { passive: false });
            
            return card;
        }

        // Handle card click
        function handleCardClick(card) {
            if (!gameActive || card.classList.contains('flipped') || flippedCards.length >= 2) return;
            card.classList.add('flipped');
            flippedCards.push(card);
            if (flippedCards.length === 2) {
                moves += 1;
                movesDisplay.textContent = `‡§ö‡§æ‡§≤‡§π‡§∞‡•Ç: ${moves}`;
                checkMatch();
            }
        }

        // Check for match
        function checkMatch() {
            const [card1, card2] = flippedCards;
            if (card1.dataset.type === card2.dataset.type) {
                score += 10;
                scoreDisplay.textContent = `‡§∏‡•ç‡§ï‡•ã‡§∞: ${score}`;
                matchedPairs += 1;
                flippedCards = [];
                if (matchedPairs === totalPairs) {
                    endGame();
                }
            } else {
                mistakes += 1;
                mistakesDisplay.textContent = `‡§ó‡§≤‡•ç‡§§‡•Ä‡§π‡§∞‡•Ç: ${mistakes}`;
                setTimeout(() => {
                    card1.classList.remove('flipped');
                    card2.classList.remove('flipped');
                    flippedCards = [];
                }, 800);
            }
        }

        // Initialize game
        function initGame() {
            gameArea.innerHTML = '';
            cards = [];
            flippedCards = [];
            matchedPairs = 0;
            score = 0;
            moves = 0;
            mistakes = 0;
            seconds = 0;
            scoreDisplay.textContent = `‡§∏‡•ç‡§ï‡•ã‡§∞: ${score}`;
            movesDisplay.textContent = `‡§ö‡§æ‡§≤‡§π‡§∞‡•Ç: ${moves}`;
            mistakesDisplay.textContent = `‡§ó‡§≤‡•ç‡§§‡•Ä‡§π‡§∞‡•Ç: ${mistakes}`;
            timerDisplay.textContent = `‡§∏‡§Æ‡§Ø: ${formatTime(seconds)}`;
            const shuffledTypes = shuffle([...types]);
            shuffledTypes.forEach(type => {
                const card = createCard(type);
                gameArea.appendChild(card);
                cards.push(card);
            });
        }

        // Reset game
        function resetGame() {
            gameActive = false;
            clearInterval(timerInterval);
            gameOverDisplay.style.display = 'none';
            startScreen.style.display = 'flex';
            gameArea.innerHTML = '';
            cards = [];
            flippedCards = [];
            matchedPairs = 0;
            score = 0;
            moves = 0;
            mistakes = 0;
            seconds = 0;
            scoreDisplay.textContent = `‡§∏‡•ç‡§ï‡•ã‡§∞: ${score}`;
            movesDisplay.textContent = `‡§ö‡§æ‡§≤‡§π‡§∞‡•Ç: ${moves}`;
            mistakesDisplay.textContent = `‡§ó‡§≤‡•ç‡§§‡•Ä‡§π‡§∞‡•Ç: ${mistakes}`;
            timerDisplay.textContent = `‡§∏‡§Æ‡§Ø: ${formatTime(seconds)}`;
            exitFullscreen();
        }

        // Start game
        function startGame() {
            startScreen.style.display = 'none';
            gameOverDisplay.style.display = 'none';
            gameActive = true;
            initGame();
            startTimer();
        }

        // End game
        function endGame() {
            gameActive = false;
            clearInterval(timerInterval);
            if (score > highScore) {
                highScore = score;
                highScoreDisplay.textContent = `‡§â‡§ö‡•ç‡§ö ‡§∏‡•ç‡§ï‡•ã‡§∞: ${highScore}`;
                setHighScore(highScore);
            }
            if (!bestTime || seconds < bestTime) {
                bestTime = seconds;
                bestTimeDisplay.textContent = `‡§â‡§§‡•ç‡§§‡§Æ ‡§∏‡§Æ‡§Ø: ${formatTime(bestTime)}`;
                setBestTime(bestTime);
            }
            finalScoreDisplay.textContent = score;
            finalHighScoreDisplay.textContent = highScore;
            finalMovesDisplay.textContent = moves;
            finalMistakesDisplay.textContent = mistakes;
            finalTimeDisplay.textContent = formatTime(seconds);
            finalBestTimeDisplay.textContent = bestTime ? formatTime(bestTime) : '--:--';
            gameOverDisplay.style.display = 'flex';
            exitFullscreen();
        }

        // Fullscreen functionality
        function enterFullscreen() {
            if (gameContainer.requestFullscreen) {
                gameContainer.requestFullscreen();
            } else if (gameContainer.webkitRequestFullscreen) {
                gameContainer.webkitRequestFullscreen();
            }
            document.body.classList.add('fullscreen-mode');
        }

        function exitFullscreen() {
            if (document.fullscreenElement || document.webkitFullscreenElement) {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                }
            }
            document.body.classList.remove('fullscreen-mode');
        }

        // Screenshot functionality
        function takeScreenshot() {
            if (typeof html2canvas === 'undefined') {
                alert('Screenshot library not yet loaded. Try again in a moment.');
                return;
            }
            html2canvas(gameContainer, {
                scale: window.devicePixelRatio
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä_‡§Æ‡•ç‡§Ø‡§æ‡§ö_‡§∏‡•ç‡§ï‡•ã‡§∞_${score}.png`;
                link.href = canvas.toDataURL();
                link.click();
            }).catch(err => {
                console.error(err);
                alert('‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§®‡§∏‡§ü ‡§≤‡§ø‡§® ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§≠‡§Ø‡•ã‡•§ ‡§ï‡§®‡•ç‡§∏‡•ã‡§≤ ‡§π‡•á‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç‡•§');
            });
        }

        // Share handlers
        function shareToTikTok(e) {
            e.preventDefault();
            if (navigator.share) {
                navigator.share({
                    title: `‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•ç‡§Ø‡§æ‡§ö - ‡§∏‡•ç‡§ï‡•ã‡§∞ ${score}!`,
                    text: `‡§Æ‡•à‡§≤‡•á ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•ç‡§Ø‡§æ‡§ö‡§Æ‡§æ ${score} ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§∞ ${formatTime(seconds)} ‡§∏‡§Æ‡§Ø‡§Æ‡§æ ‡§ú‡§ø‡§§‡•á‡§Ç! ‡§§‡§™‡§æ‡§à‡§Ç ‡§™‡§®‡§ø ‡§ñ‡•á‡§≤‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç üéÆ`,
                    url: window.location.href
                }).catch(console.error);
            } else {
                const text = `‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•ç‡§Ø‡§æ‡§ö - ‡§∏‡•ç‡§ï‡•ã‡§∞ ${score}! ‡§∏‡§Æ‡§Ø ${formatTime(seconds)}! ‡§∂‡•Å‡§≠ ‡§¶‡§∂‡•à‡§Ç! üéâ\n${window.location.href}`;
                navigator.clipboard.writeText(text).then(() => alert('‡§ü‡§ø‡§ï‡§ü‡§ï‡§ï‡•ã ‡§≤‡§æ‡§ó‡§ø ‡§≤‡§ø‡§ô‡•ç‡§ï ‡§ï‡§™‡•Ä ‡§≠‡§Ø‡•ã! ‡§™‡•á‡§∏‡•ç‡§ü ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç‡•§')).catch(() => alert('‡§ï‡§™‡•Ä ‡§ó‡§∞‡•ç‡§® ‡§∏‡§ï‡§ø‡§è‡§®‡•§'));
            }
        }

        function shareToFacebook(e) {
            e.preventDefault();
            const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}&quote=${encodeURIComponent('‡§Æ‡•à‡§≤‡•á ‡§Æ‡•á‡§Æ‡•ã‡§∞‡•Ä ‡§Æ‡•ç‡§Ø‡§æ‡§ö‡§Æ‡§æ ' + score + ' ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§∞ ' + formatTime(seconds) + ' ‡§∏‡§Æ‡§Ø‡§Æ‡§æ ‡§ú‡§ø‡§§‡•á‡§Ç! ‡§∂‡•Å‡§≠ ‡§¶‡§∂‡•à‡§Ç! üéâ')}`;
            window.open(url, '_blank', 'width=600,height=400');
        }

        // Event listeners
        playBtn.addEventListener('click', startGame);
        playBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            startGame();
        }, { passive: false });
        
        restartBtn.addEventListener('click', () => {
            resetGame();
            startGame();
        });
        restartBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            resetGame();
            startGame();
        }, { passive: false });
        
        screenshotBtn.addEventListener('click', takeScreenshot);
        screenshotBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            takeScreenshot();
        }, { passive: false });
        
        tiktokShare.addEventListener('click', shareToTikTok);
        tiktokShare.addEventListener('touchstart', (e) => {
            e.preventDefault();
            shareToTikTok(e);
        }, { passive: false });
        
        facebookShare.addEventListener('click', shareToFacebook);
        facebookShare.addEventListener('touchstart', (e) => {
            e.preventDefault();
            shareToFacebook(e);
        }, { passive: false });

        fullscreenBtn.addEventListener('click', enterFullscreen);
        fullscreenBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            enterFullscreen();
        }, { passive: false });

        cancelFullscreenBtn.addEventListener('click', exitFullscreen);
        cancelFullscreenBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            exitFullscreen();
        }, { passive: false });

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            resetGame();
        });

        // Clean up on unload
        window.addEventListener('beforeunload', () => {
            gameActive = false;
            clearInterval(timerInterval);
            exitFullscreen();
        });

        // Prevent double-tap zoom
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, { passive: false });
    </script>
</body>
</html>
